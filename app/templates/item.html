{% extends "base.html" %}
{% block head %}
{{ super() }}
<title>{{ title }}</title>
{% endblock %}
{% block content %}
{% include "comp/header.html" %}

<div class="ui container" id="container">
<table class="ui definition table">
  <thead>
    <tr class="center aligned">
      <th></th>
      <th>{{ data.title }}</th>
    </tr>
  </thead>
  <tbody>
  <tr class="center aligned">
    <td class="six wide">类型</td>
    <td class="ten wide">{{ data.type }}</td>
  </tr>
  {% for d in data.attributes %}
    <tr class="center aligned">
      <td class="six wide">{{ d.key }}</td>
      <td class="ten wide">{{ d.attr }}</td>
    </tr>
  {% endfor %}

  </tbody>
</table>
    <div class="ui accordion">
      <div class="title">
        <a class=" ui icon teal button">
          <i class="icon plus"></i>添加属性
        </a>
      </div>
      <div class="content">
        <div class="ui horizontal divider"><h3><i class="list icon"></i>属性名</h3></div>
        <div class="ui fluid icon input">
          <input id="attr_name" type="text" placeholder="属性名...">
        </div>
        <div class="ui horizontal divider"><h3><i class="tag icon"></i>属性类型</h3></div>
        <div id="tab">
          <div class="ui secondary menu">
            <a class="item red button type active" data-tab="text">文本</a>
            <a class="item orange button type" data-tab="img">图片</a>
            <a class="item yellow button type" data-tab="url">超链接</a>
            <a class="item olive button type" data-tab="bool">是/否</a>
            <a class="item green button type" data-tab="star">星级</a>
            <a class="item teal button type" data-tab="num">数值</a>
          </div>

          <div class="ui tab active" data-tab="text">
            <div class="ui form">
              <div class="field">
                <textarea id="text"></textarea>
              </div>
            </div>
          </div>

          <div class="ui tab" data-tab="img">
            <div class="ui labeled fluid input">
              <div class="ui label">图片URL</div>
              <input id="img" type="url" placeholder="http://...">
            </div>
          </div>
          <div class="ui tab" data-tab="url">
            <div class="ui labeled fluid input">
              <div class="ui label">超链接</div>
              <input id="url" type="url" placeholder="http://...">
            </div>
          </div>
          <div class="ui tab" data-tab="bool">
            <button id="bool" class="ui toggle button">否</button>
          </div>
          <div class="ui tab" data-tab="star">
            <div id="star" class="ui massive star rating"></div>
          </div>
          <div class="ui tab" data-tab="num">
            <div class="ui action input">
              <input id="num" type="number" placeholder="输入数值...">
              <select class="ui compact selection dropdown">
                <option value="weight">重量</option>
                <option value="length">长度</option>
                <option value="area">面积</option>
                <option value="currency">货币</option>
              </select>
              <select class="ui compact selection dropdown" id="num-unit">
                <option value="all"> </option>
              </select>
            </div>

          </div>
        </div>
        <button id="add_attr" class="ui teal button fluid" style="margin:1em 0;">添加</button>
      </div>
    </div>
</div>
{% endblock %}
{% block js %}
<script>
    $(function(){
      $('.ui.accordion').accordion();
      $('#star')
        .rating({
          initialRating: 3,
          maxRating: 5
        });

      $('.ui.toggle.button')
      .state({
        text: {
          inactive : '否',
          active   : '是'
        }
      });

      $('#tab .menu .item')
        .tab({
          context: 'parent'
        });

      $("#add_attr").on("click", function(ev) {
        var active_tab = $('.ui.tab.active');
        var type = active_tab.attr('data-tab');
        var value = null;
        if (type == 'text')
          value = $("#text").val();
        else if (type == 'img')
          value = $("#img").val();
        else if (type == 'url')
          value = $("#url").val();
        else if (type == 'bool')
          value = $("#bool").hasClass('active');
        else if (type == 'star')
          value = $('#star').rating("get rating");
        else if (type == 'num')
          value = $('#num').val() + $('num-unit').val();
        else
          throw new RangeError();
        if(value == undefined) value = "";
        console.log(value);
      });
    });
</script>
{% endblock %}
